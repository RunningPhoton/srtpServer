package com.demo.services.impl;

import java.util.List;

import com.demo.database.data.TDemoCircle;
import com.demo.database.data.TDemoCircleMessage;
import com.demo.database.data.TDemoMessage;
import com.demo.database.data.TDemoUser;
import com.demo.database.idao.IDaoService;
import com.demo.services.IUserService;


/**
 * 用户操作业务逻辑实现类
 * @author runningphoton
 *
 */
public class UserService implements IUserService {
	private IDaoService idaoService;
	private TDemoUser user;

	public IDaoService getIdaoService() {
		return idaoService;
	}

	public void setIdaoService(IDaoService idaoService) {
		this.idaoService = idaoService;
	}

	public TDemoUser getUser() {
		return user;
	}

	public void setUser(TDemoUser user) {
		this.user = user;
	}

	/**
	 * 通过userName来找到用户
	 */
	@Override
	public TDemoUser findByUserName(String userName) {
		String hql = "from TDemoUser where userName='"+userName+"'";
		try {
			List<TDemoUser> list = (List<TDemoUser>) idaoService.query(hql);
			if(list != null) 
				return list.get(0);
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
		return null;
	}

	@Override
	public void fresh() throws Exception {
		this.user = findByUserName(this.user.getUserName());
	}

	@Override
	public void addFriend(TDemoUser user) throws Exception {
		this.user.addFriend(user);
		idaoService.update(this.user);
	}

	@Override
	public void removeFriend(TDemoUser user) throws Exception {
		this.user.removeFriend(user);
		idaoService.update(this.user);
	}

	@Override
	public void setCircle(TDemoCircle circle) throws Exception {
		this.user.setUserCircle(circle);
		idaoService.update(this.user);
	}

	@Override
	public void removeCircle(TDemoCircle circle) throws Exception {
		this.user.setUserCircle(null);
		idaoService.update(this.user);
	}

	@Override
	public void sendUserMessage(TDemoMessage message) throws Exception {
		// TODO Auto-generated method stub

	}

	@Override
	public void sendCircleMessage(TDemoCircleMessage circleMessage)
			throws Exception {
		// TODO Auto-generated method stub

	}

}
